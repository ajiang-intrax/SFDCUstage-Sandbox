<apex:page id="apc_hf_match_payment_checkout" docType="html-5.0" applyHtmlTag="false"
           applyBodyTag="false" title="Payment Gateway" standardStylesheets="false"
           showHeader="false" controller="apc_portal_controller" action="{!paymentController.init}">    
    
    <apex:includeScript value="{!URLFOR($Resource.intrax_themes, '/intrax_themes/js/jquery-1.8.0.min.js')}"/>  
    <apex:includeScript value="{!URLFOR($Resource.intrax_themes, '/intrax_themes/js/jquery-ui-1.8.23.custom.min.js')}"/>
    
    <style>
        .btn-primary1 {
        background-color: #7CB040;
        border-color: #72a23b;
        color: #FFFFFF;
        }
    </style>
    
    <apex:composition template="intraxtemplate_vs3">
        <apex:define name="body">
          <apex:outputText rendered="{!ApplicantInfo.Application_Type__c <> 'Extension'}">
            <c:menu_apc_hf_match_checkout />
          </apex:outputText>
            <apex:form styleClass="form-vertical ws-validate" id="webform">
                <apex:outputPanel layout="block" id="failpayment" rendered="{!NOT(paymentController.isPaymentSuccessful)}">
                    <p class="alert alert-danger"><button data-dismiss="alert" class="close" type="button">x</button>{!paymentController.paymentError}</p>
                </apex:outputPanel>
        <!-- <apex:pageMessages id="messageapex" />-->
                <div class="row">
                    <div  class="col-sm-12 col-lg-10 center-block">
                        <div class="row margin-t2">                                    
                            <div class="col-sm-8">
                                <apex:outputPanel id="paymentNotRequired" rendered="{!If(paymentController.amount==0 && ApplicantInfo.Application_Type__c=='Rematch',true,false)}">
                                <div class="lead alert alert-warning clearfix">
                                    You do not need to pay any program fee now. The service credit from your previous application will offset the fee which is due now.
                                    Please confirm if you want to proceed with this.
					            </div>
                                    			<div class="row">
                                                    <div class="col-sm-12 margin-t">
                                                        
                                                        <apex:commandLink styleClass="btn btn-link btn-lg" action="{!paymentController.navigateToPaymentOptionsPage}"
                                                                          id="PaymentOptionsButton" immediate="true">
                                                            <i class="fa fa-chevron-left"></i>
                                                            <span>Back</span>
                                                        </apex:commandLink>
                                                        
                                                        <apex:commandlink styleClass="btn btn-primary btn-lg margin-r2" action="{!paymentController.noPaymentRequired}" id="noPaymentButton" onComplete="rerunjs();" status="onsubmit" reRender="webform,runscript">       
                                                            <apex:param name="nextPage"
                                                                        value="/apex/apc_hf_match_payment_confirmation" />
                                                            <apex:param name="reDirectPage" value="true" />
                                                            <apex:param name="viewpage" value="true" />
                                                            <apex:param name="expireMonth" value="{!paymentController.monthSelected}" />
                                                            <apex:param name="expireYear" value="{!paymentController.yearSelected}" />
                                                            <apex:param name="maskCCNumber" value="{!paymentController.maskedCCNumber}" />
                                                            <apex:param name="paymentId" value="{!paymentController.paymentRecordId}" />  
                                                            <apex:param name="sAppId" value="{!paymentController.applicantInfo.Id}" />
                                                            <apex:commandButton value="Submit" id="noPaymentConfirmButton"/>
                                                            <!-- <INPUT TYPE="BUTTON" VALUE="Submit Payment" id="confirmbutton" NAME="submission" ONCLICK="doSubmit(this.form)"/>-->
                                                        </apex:commandlink>
                                                       
                                                        <div class="margin-t2"><em>Submitting this form will use your service credit.</em></div>
                                                        
                                                    </div>
                                                </div><!--  end row -->
                                
                                </apex:outputPanel>
                                
                                <apex:outputPanel layout="block" id="paymentfirst" rendered="{!paymentController.amount!=0 && paymentController.TokenRetrive.size == 0}">
                                    <apex:outputPanel rendered="{!NOT(paymentController.isConfirmPayment)}">    
                                        <apex:outputPanel layout="block" id="paymentpanel" >
                                            <h2 class="no-margin-t margin-b4">Please Enter Your Credit Card Information</h2>
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label">First Name</label>
                                                        <apex:inputText styleClass="form-control fname" value="{!paymentController.payment.Billing_FirstName__c}"
                                                                        required="true"  id="billingFirstName" />
                                                        <apex:message for="billingFirstName"
                                                                      styleClass="custom-error-text" />
                                                    </div>
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label">Last Name</label>
                                                        <apex:inputText styleClass="form-control lname" value="{!paymentController.payment.Billing_LastName__c}"
                                                                        required="true" id="billingLastName" />
                                                        <apex:message for="billingLastName" styleClass="custom-error-text" />
                                                    </div>
                                                </div>
                                            </div>
                                            <!--  end row -->
                                            
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label"> Credit Card Number </label>
                                                        <apex:inputText styleClass="form-control" value="{!paymentController.payWrapper.ccNumber}"
                                                                      id="cardnumber" />
                                                        <apex:message for="cardnumber"
                                                                      styleClass="custom-error-text" />
                                                    </div>
                                                </div>
                                                <div class="col-sm-4">
                                                    <div class="form-group">
                                                        <label class="control-label">CVV code</label>
                                                        <apex:inputText styleClass="form-control short" value="{!paymentController.payWrapper.cvvNumber}" 
                                                                         id="cvcode" />
                                                        <apex:message for="cvcode" styleClass="custom-error-text" />
                                                        <apex:commandLink id="helptext" onclick="CVVHelpTextModal();" rerender="none"> 
			  											<b class="sm">What is my CVV code?</b>
			  											</apex:CommandLink>
                                                    </div>
                                                </div>
                                            </div>
                                            <!--  end row -->
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label">Type of Card</label>
                                                        <apex:selectList styleClass="form-control cctype req" value="{!paymentController.TypeCreditCardSelected}" multiselect="false" size="1" id="listcardtypes" required="true">
                                                            <apex:selectOption itemValue="" itemLabel=" --Please Choose-- "/>
                                                            <apex:selectOptions value="{!paymentController.TypeCard}"/>
                                                        </apex:selectList>
                                                        <div><a id="visabtn" name="Visa" class="creditc-icon">Visa</a>
                                                            <a name="MasterCard" id="mastercardbtn" class="creditc-icon">MasterCard</a>
                                                            <a name="AmericanExpress" id="amexbtn" class="creditc-icon">American Express</a>
                                                            <a name="Discover" id="discbtn" class="creditc-icon">Discover Card</a>
                                                        </div>
                                                        <apex:message for="listcardtypes" styleClass="custom-error-text" />
                                                    </div>
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label"> Expiration Date </label>
                                                        <div class="row">
                                                            <div class="col-sm-6">
                                                                <apex:selectList styleClass="form-control req" value="{!paymentController.monthSelected}"
                                                                                 multiselect="false" size="1"
                                                                                 id="monthlist" required="true" >
                                                                    <apex:selectOption itemValue="" itemLabel=" --Month-- " />
                                                                    <apex:selectOptions value="{!paymentController.Month}" />
                                                                </apex:selectList>
                                                                <apex:message for="monthlist" styleClass="custom-error-text" />
                                                            </div>
                                                            <div class="col-sm-5" style="padding-left:0;">
                                                                <apex:selectList styleClass="form-control req" value="{!paymentController.yearSelected}" 
                                                                                 multiselect="false" size="1" id="yearlist" required="true" >
                                                                    <apex:selectOption itemValue="" itemLabel=" --Year-- " />
                                                                    <apex:selectOptions value="{!paymentController.year}" />
                                                                </apex:selectList>
                                                                <apex:message for="yearlist" styleClass="custom-error-text" />
                                                            </div>
                                                        </div>
                                                        <!--  end row --> 
                                                        
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                        
                                        <apex:outputPanel layout="block" id="addressfieldsPanel">
                                            <div class="section-title">Billing Address</div>
                                            <div class="row">
                                                <div class="col-sm-12 margin-b">
                                                    <div class="form-group margin-b1">
                                                        <apex:actionRegion >
                                                            <apex:inputCheckbox styleClass="checkbox" id="billingAddressCheckbox" value="{!paymentController.useCurrentBillingAddressInfo}"> 
                                                                <apex:actionSupport event="onchange" reRender="addressfieldsPanel" action="{!paymentController.blankOutAddressDetailsOnPaymentPage}" onComplete="restoreclass();" status="addinfoload"/>
                                                            </apex:inputCheckbox>
                                                        </apex:actionRegion>
                                                       
                                                        <label>Check if same as physical address</label></div>
                                                    <apex:message for="billingAddressCheckbox" styleClass="custom-error-text" />
                                                    <apex:actionStatus onstart="disableSubmit();" onstop="enableSubmit();" startStyleClass="feedback-st" startText="Loading. Please wait..." id="addinfoload"/>
                                                </div>
                                            </div>
                                            <!--  end row -->
                                            
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label"> Email </label>
                                                        <apex:inputtext styleClass="form-control" value="{!paymentController.PaySubsWrapper.BillingEmail}"
                                                                        required="true"   id="billingEmail" />
                                                        <apex:message for="billingEmail"
                                                                      styleClass="custom-error-text" />
                                                    </div>
                                                </div>
                                            </div>
                                            <!--  end row -->
                                            
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label">Street Address 1</label>
                                                        <apex:inputtext styleClass="form-control" html-placeholder="Street address" onblur="CapitalizeName(event.target);" value="{!paymentController.PaySubsWrapper.BillingStreet}"
                                                                        required="true"  id="street1" />
                                                        <apex:message for="street1" styleClass="custom-error-text" />
                                                    </div>
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label">Street Address 2 <span class="info">(Optional)</span></label>
                                                        <apex:inputtext styleClass="form-control" html-placeholder="Apartment, building, floor, etc." onblur="CapitalizeName(event.target);" value="{!paymentController.PaySubsWrapper.BillingStreet2}"
                                                                        required="False" id="street2" />
                                                    </div>
                                                </div>
                                            </div>
                                            <!--  end row -->
                                            
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label">City</label>
                                                        <apex:inputtext styleClass="form-control" onblur="CapitalizeName(event.target);" value="{!paymentController.PaySubsWrapper.BillingCity}"
                                                                        required="TRUE" id="city" />
                                                        <apex:message for="city" styleClass="custom-error-text" />
                                                    </div>
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label">State</label>
                                                        <apex:inputText styleClass="form-control short"
                                                                         html-placeholder="XX" html-pattern="[A-Z]{2}"
                                                                         onblur="UpperCase(event.target);"
                                                                         value="{!paymentController.PaySubsWrapper.BillingState}"
                                                                         required="TRUE" id="state" />
                                                        <apex:message for="state" styleClass="custom-error-text" />                    
                                                    </div>
                                                </div>
                                            </div>
                                            <!--  end row -->
                                            
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label">Country</label>
                                                        <apex:inputtext styleClass="form-control" onblur="CapitalizeName(event.target);"
                                                                        value="{!paymentController.PaySubsWrapper.BillingCountry}"
                                                                        required="TRUE" id="country" />
                                                        <apex:message for="country" styleClass="custom-error-text" />
                                                    </div>
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="control-label"> Postal Code </label>
                                                        <apex:inputtext styleClass="form-control" value="{!paymentController.PaySubsWrapper.BillingPostalCode}"
                                                                        required="TRUE" id="zip" />
                                                        <apex:message for="zip" styleClass="custom-error-text" />
                                                    </div>
                                                </div>
                                            </div>
                                            <!--  end row --> 
                                            
                                        </apex:outputPanel>
                                        
                                             
                                        <apex:outputPanel layout="block" rendered="True" id="authorized">
                                            <div class="well"> 
                                                <div class="tcell"> 
                                                    
                                                    <apex:actionRegion >
                                                       <apex:inputCheckBox id="ccauthorized2" styleClass="form-control ccauthorized" 
                                                                            
                                                                            required="true">
                                                            <!--<apex:actionSupport event="onclick" immediate="true" rerender=""
                                                                                oncomplete="checkingBool();"/> -->
                                                        </apex:inputCheckBox>
                                                        
                                                    </apex:actionRegion>
                  
                                                </div>     
                                                <div class="tcell">I authorize AuPairCare to automatically charge the credit card provided per the due date(s) reflected on the invoice(s) associated with the requested match.</div>  
                                            </div>  
                                        </apex:outputPanel>
                                     
                                        <apex:commandlink styleClass="btn btn-primary1 btn-lg" action="{!paymentController.navigateToPaymentNonEditPage}"
                                                          id="nextlink" onComplete="rerunjs();" reRender="webform" status="onsubmit1">
                                            <apex:commandButton value="Continue" id="continuebutton"/>
                                        </apex:commandlink>                                    
                                    </apex:outputPanel>
                                </apex:outputPanel>
                                
                                <apex:outputPanel layout="block" id="paymentsecond" rendered="{!paymentController.amount!=0 && paymentController.TokenRetrive.size == 0}">     
                                    <apex:outputPanel layout="block" rendered="{!paymentController.isConfirmPayment}">
                                        <div class="col-sm-8">     
                                            <apex:ActionRegion >
                                              <!--  <apex:pageMessages /> -->
                                                <h2 class="no-margin-t">Payment Confirmation</h2>                                           
                                                <p class="lead">Please review the information below for accuracy.</p>                                                                                             
                                                <style>
                                                    .payrow label{width:200px; margin-bottom:10px;}
                                                </style>
                                                
                                                <div class="payment-conf">
                                                    
                                                    <div class="payrow">
                                                        <label>Type of Card</label>
                                                        <apex:outputText value="{!paymentController.TypeCreditCardSelected}"
                                                                         id="typCardout" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Credit Card Number</label>
                                                        <apex:outputText value="{!paymentController.maskedCCNumber}" id="maskCCout" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Expiration Date</label>
                                                        <apex:outputText value="{!paymentController.monthSelected} / {!paymentController.yearSelected}"
                                                                         id="expiration" styleClass="short margin-r"></apex:outputText>
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Name</label>
                                                        <apex:outputText value="{!paymentController.payment.Billing_FirstName__c}" id="cardnameoutf" />
                                                        &nbsp;
                                                        <apex:outputText value="{!paymentController.payment.Billing_LastName__c}" id="cardnameoutl" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Email</label>
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.BillingEmail}"
                                                                         id="cardemailout"></apex:outputText>
                                                    </div>
                                                    
                                                    
                                                    <div class="payrow">
                                                        <label>Street Address 1</label>
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.BillingStreet}"
                                                                         id="steet1out" />
                                                    </div>
                                                    
                                                    <apex:outputPanel layout="block" rendered="{!paymentController.PaySubsWrapper.BillingStreet2!=null}">
                                                        <div class="payrow">
                                                            <label>Street Address 2</label>
                                                            <apex:outputText value="{!paymentController.PaySubsWrapper.BillingStreet2}"
                                                                             id="street2out" />
                                                        </div>
                                                    </apex:outputPanel>
                                                    
                                                    <div class="payrow">
                                                        <label>City</label>
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.BillingCity}"
                                                                         id="cityout" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>State</label>
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.BillingState}"
                                                                         id="stateout" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Country</label>
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.BillingCountry}"
                                                                         id="countryout" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Postal Code</label>
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.BillingPostalCode}" id="zipout" />
                                                    </div>
                                                    
                                                </div><!--  end payment-conf -->
                                                
                                                <div class="row">
                                                    <div class="col-sm-12 margin-t">
                                                        
                                                        <apex:commandLink styleClass="btn btn-link btn-lg" action="{!paymentController.backToPaymentEditPage}"
                                                                          id="theCommandLink" immediate="true">
                                                            <i class="fa fa-chevron-left"></i>
                                                            <span>Back</span>
                                                        </apex:commandLink>
                                                        
                                                        <apex:commandlink styleClass="btn btn-primary btn-lg margin-r2" action="{!paymentController.makeAWSPayment}" id="nextlink1" onComplete="rerunjs();" status="onsubmit" reRender="webform,runscript">       
                                                            <apex:param name="nextPage"
                                                                        value="/apex/apc_hf_match_payment_confirmation" />
                                                            <apex:param name="reDirectPage" value="true" />
                                                            <apex:param name="viewpage" value="true" />
                                                            <apex:param name="expireMonth" value="{!paymentController.monthSelected}" />
                                                            <apex:param name="expireYear" value="{!paymentController.yearSelected}" />
                                                            <apex:param name="maskCCNumber" value="{!paymentController.maskedCCNumber}" />
                                                            <apex:param name="paymentId" value="{!paymentController.paymentRecordId}" />  
                                                            <apex:param name="sAppId" value="{!paymentController.applicantInfo.Id}" />
                                                            <apex:commandButton value="Submit Payment" id="confirmbutton"/>
                                                            <!-- <INPUT TYPE="BUTTON" VALUE="Submit Payment" id="confirmbutton" NAME="submission" ONCLICK="doSubmit(this.form)"/>-->
                                                        </apex:commandlink>
                                                       
                                                        <div class="margin-t2"><em>Submitting this form will charge your credit card.</em></div>
                                                        
                                                    </div>
                                                </div><!--  end row -->
                                                
                                            </apex:ActionRegion>
                                        </div>
                                        
                                    </apex:outputPanel>
                                </apex:outputPanel>    
                                
                                <apex:outputPanel layout="block" id="paymentthird" rendered="{!paymentController.amount!=0 && paymentController.TokenRetrive.size > 0}">     
                                    <apex:outputPanel layout="block" rendered="{!paymentController.isConfirmPayment}">
                                        <div class="col-sm-8">     
                                            <apex:ActionRegion >
                                                <apex:pageMessages />
                                                <h2 class="no-margin-t">Payment Confirmation</h2>                                           
                                                <p class="lead">Is the credit card Below Still Current?</p>                                                                                             
                                                <style>
                                                    .payrow label{width:200px; margin-bottom:10px;}
                                                </style>
                                                
                                                <div class="payment-conf">
                                                    
                                                    <div class="payrow">
                                                        <label>Type of Card</label>
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.cardType}" id="typCardout2" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Credit Card Number</label>
                                                        <apex:outputText value="{!paymentController.maskedCCNumber}" id="maskCCout2" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Expiration Date</label>
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.cardExpirationMonth}  / {!paymentController.PaySubsWrapper.cardExpirationYear}"
                                                                         id="expiration2" styleClass="short margin-r"></apex:outputText>
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Name</label>
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.firstName}" id="cardnameoutf2" />
                                                        &nbsp;
                                                        <apex:outputText value="{!paymentController.PaySubsWrapper.LastName}" id="cardnameoutl2" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Email</label>
                                                        <apex:outputText value="{!paymentController.accountInfo[0].PersonEmail}"
                                                                         id="cardemailout2"></apex:outputText>
                                                    </div>
                                                    
                                                    
                                                    <div class="payrow">
                                                        <label>Street Address 1</label>
                                                        <apex:outputText value="{!paymentController.accountInfo[0].BillingStreet}"
                                                                         id="steet1out2" />
                                                    </div>
                                                    
                                                    <apex:outputPanel layout="block" rendered="{!paymentController.payment.Billing_Street_2__c!=null}">
                                                        <div class="payrow2">
                                                            <label>Street Address 2</label>
                                                            <apex:outputText value="{!paymentController.payment.Billing_Street_2__c}"
                                                                             id="street2out2" />
                                                        </div>
                                                    </apex:outputPanel>
                                                    
                                                    <div class="payrow">
                                                        <label>City</label>
                                                        <apex:outputText value="{!paymentController.accountInfo[0].BillingCity}"
                                                                         id="cityout2" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>State</label>
                                                        <apex:outputText value="{!paymentController.accountInfo[0].BillingState}"
                                                                         id="stateout2" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Country</label>
                                                        <apex:outputText value="{!paymentController.accountInfo[0].BillingCountry}"
                                                                         id="countryout2" />
                                                    </div>
                                                    
                                                    <div class="payrow">
                                                        <label>Postal Code</label>
                                                        <apex:outputText value="{!paymentController.accountInfo[0].BillingPostalCode}" id="zipout2" />
                                                    </div>
                                                    
                                                </div><!--  end payment-conf -->
                                                
                                                <div class="row">
                                                    <div class="col-sm-12 margin-t">
                                                        
                                                        <!--
                                                        <apex:commandLink styleClass="btn btn-link btn-lg" action="{!paymentController.backToPaymentEditPage}"
                                                                          id="theCommandLink2" immediate="true">
                                                            <i class="fa fa-chevron-left"></i>
                                                            <span>Back</span>
                                                        </apex:commandLink>-->
                                                        
                                                        <apex:commandlink styleClass="btn btn-primary btn-lg margin-r2" action="{!paymentController.makeAWSPayment}" id="nextlink12" onComplete="rerunjs();" status="onsubmit" reRender="webform,runscript">       
                                                            <apex:param name="nextPage"
                                                                        value="/apex/apc_hf_match_payment_confirmation" />
                                                            <apex:param name="reDirectPage" value="true" />
                                                            <apex:param name="viewpage" value="true" />
                                                            <apex:param name="paymentId" value="{!paymentController.paymentRecordId}" />  
                                                            <apex:param name="sAppId" value="{!paymentController.applicantInfo.Id}" />
                                                            <apex:commandButton value="Yes,Submit Payment" id="confirmbutton2"/>
                                                        </apex:commandlink>
                                                        
                                                        <apex:outputLink styleClass="blue" value="/apex/apc_cc_update">
                                                            <apex:outputText value="No, Update Credit Card" id="documentId" />
                                                        </apex:outputLink>
                                                       
                                                        <div class="margin-t2"><em>Submitting this form will charge your credit card.</em></div>
                                                        
                                                    </div>
                                                </div><!--  end row -->
                                                
                                            </apex:ActionRegion>
                                        </div>
                                        
                                    </apex:outputPanel>
                                </apex:outputPanel> 
                                
                                
                            </div><!--end col-->
                            
                            <div class="col-sm-4">
                       
                                <div class="box margin-b2" style="background: #777777; color: #fff;">
                                    <h4 class="no-margin">Payment Due Now</h4>
                                                <apex:repeat var="datekey" value="{!SelectedItemsPriceMapDueNow}">
                                                           <div class="h3 no-margin">
                                                            $<apex:outputText value="{0, number, #,##0.00}">
                                                                <apex:param value="{!SelectedItemsPriceMapDueNow[datekey]}"/>
                                                            </apex:outputText>
                                                            </div>
                                                </apex:repeat>
                                           
                                                                              
                                    
                                </div><!--  end box -->
                                
                            <apex:outputPanel id="schdPaymentsAvailable" rendered="{!(schdPaymentsAvailable==True)}">
                                <div class="box gray margin-b2">
                                    <h4>Next Scheduled Payment(s)</h4>
                                                <apex:repeat var="datekey" value="{!SelectedItemsPriceMapDueLater}">
                                                  <hr/>   
                                                       <div class="h3 no-margin">     
                                                            $<apex:outputText value="{0, number, #,##0.00}">
                                                                <apex:param value="{!SelectedItemsPriceMapDueLater[datekey]}"/>
                                                            </apex:outputText>
                                                       </div> 
                                                       <div> 
                                                       <label>Scheduled for</label>
                                                            <apex:outputText value=" {0,date,MM/dd/yyyy}">
                                                                <apex:param value="{!datekey}"/>
                                                            </apex:outputText>
                                                       </div>
                                                </apex:repeat>  
                                </div><!--  end box -->
                           </apex:outputPanel>
                                
                                <div class = "box gray">
                                                <div class="h4 no-margin">Program Total</div>
                                                <div class="h3 no-margin">
                                                    $<apex:outputText value=" {0, number, #,##0.00}">
                                                        <apex:param value="{!selectedItemsTotalPrice}"/>
                                                    </apex:outputText>
                                                </div>
                                </div><!--  end box -->
                            </div><!--end col-->
                        </div><!--end row-->
                    </div></div>      
                
                <!-- end col --> 
                
                <!-- end row --> 
                

                <!-- Modal Window -->
                <div class="modal fade vs1" id="myModalAddress" tabindex="-1"
                     role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
                    <div class="modal-dialog modal-sm">
                        <div class="modal-content">
                            <div class="modal-body">
                                <p><label>Please check Authorization checkbox.</label></p>
                            </div>
                        </div>
                    </div>
                </div>
    
        <div class="modal fade vs1"  id="ModalCVVHelpText" tabindex="-1"
           role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
              <apex:commandLink styleClass="closebtn" html-data-dismiss="modal" reRender="none"> <span class="fa-stack fa-lg "> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-times fa-stack-1x fa-inverse"></i> </span> </apex:commandLink> 
            <div class="modal-body"> 
                 <c:block_cvv_number_help_text ></c:block_cvv_number_help_text>
              </div>
          </div>
        </div>
      </div>
                
                <script>
                
                var j$ = jQuery.noConflict(); 
                j$('.creditc-icon').bind('click', function () {
                    var cc = j$(this).attr("name");
                    j$('.cctype option[value="' + cc + '"]').prop('selected', true);
                });
                
                j$( document ).ready(function() {
                    j$('.fname').attr('value','{!paymentController.personinfo.First_Name__c}');
                    j$('.lname').attr('value','{!paymentController.personinfo.Last_Name__c}');
                });
                
                //move to the top of the page
                function goToTheTop(){
                    j$('html, body').animate({ scrollTop: 0 }, 'slow');
                }
                
                function DisableBtn(){
                    //alert('hii');
                    if (!disablepromo == true)
                    {document.getElementById('promocode').disabled = true;
                     document.getElementById('applypromolink').disabled= true;}
                }
                
                var submitted = false;
                
                function doSubmit(form) {
                    if (!submitted) {
                        submitted = true;
                        form.submit();
                    }
                }
                
                	
                j$(document).ready(function() {
                    checkingBool();
                });
                
                
                j$('input.ccauthorized:checkbox').click(function(){
                   checkingBool();
                });
                
                function checkingBool(){
                    if(j$('input.ccauthorized:checkbox').is(':checked')){
                        j$('.btn-primary1').removeAttr('disabled');
                    }else{
                        j$('.btn-primary1').attr('disabled', 'disabled');
                    }
                }
                
                 function enableLoading1(){
                    j$('.btn-primary1').button('loading');
                }
                
                function disableLoading1(){
                    j$('.btn-primary1').button('reset');
                    j$('html, body').animate({ scrollTop: 0 }, 'slow');
                }
                
                function CVVHelpTextModal(){
                var auxerr= j$('.custom-error-pagelevel').attr('role');
                //alert(auxerr);
                if(auxerr=="alert"){
                }else{
                    j$('#ModalCVVHelpText').modal();
                }
            } 
                
                </script>
                <apex:actionstatus id="onsubmit1" onstart="enableLoading1();" onstop="disableLoading1();"/>
            </apex:form>
        </apex:define>
    </apex:composition>
</apex:page>